script: script.R

artefacts:
  - data:
      description: All area datasets
      filenames:
        - areas.rds
        - areas.pdf
        - area-levels.txt
  - data:
      description: All survey and HIV indicator datasets
      filenames:
        - survey_indicators_sexbehav.csv
        - survey_indicators_sexbehav.pdf
        - hiv_indicators_sexbehav.csv
  - data:
      description: Compare spouse risk group sizes
      filenames:
        - spouse-comparison.pdf
        - spouse-livesaway.pdf
        # - mwi-dhs-phia-comparison.pdf

packages:
  - dplyr
  - forcats
  - ggplot2
  - INLA
  - naomi
  - readr
  - scales
  - sf
  - spdep
  - tidyr
  - purrr
  - stringr
  - Matrix
  - spud
  - gt

depends:
  - process_areas:
      id: latest
      use:
        depends/bwa_areas.geojson: bwa_areas.geojson
        depends/cmr_areas.geojson: cmr_areas.geojson
        depends/ken_areas.geojson: ken_areas.geojson
        depends/lso_areas.geojson: lso_areas.geojson
        depends/moz_areas.geojson: moz_areas.geojson
        depends/mwi_areas.geojson: mwi_areas.geojson
        depends/nam_areas.geojson: nam_areas.geojson
        depends/swz_areas.geojson: swz_areas.geojson
        depends/tza_areas.geojson: tza_areas.geojson
        depends/uga_areas.geojson: uga_areas.geojson
        depends/zaf_areas.geojson: zaf_areas.geojson
        depends/zmb_areas.geojson: zmb_areas.geojson
        depends/zwe_areas.geojson: zwe_areas.geojson
        depends/bfa_areas.geojson: bfa_areas.geojson
        depends/ago_areas.geojson: ago_areas.geojson
        depends/cod_areas.geojson: cod_areas.geojson
        depends/gab_areas.geojson: gab_areas.geojson
        depends/rwa_areas.geojson: rwa_areas.geojson
        depends/eth_areas.geojson: eth_areas.geojson
        # depends/hti_areas.geojson: hti_areas.geojson
        depends/tcd_areas.geojson: tcd_areas.geojson
        depends/civ_areas.geojson: civ_areas.geojson
        depends/gha_areas.geojson: gha_areas.geojson
        depends/gin_areas.geojson: gin_areas.geojson
        depends/lbr_areas.geojson: lbr_areas.geojson
        depends/mli_areas.geojson: mli_areas.geojson
        depends/ner_areas.geojson: ner_areas.geojson
        depends/sle_areas.geojson: sle_areas.geojson
        depends/tgo_areas.geojson: tgo_areas.geojson
        depends/cog_areas.geojson: cog_areas.geojson
        depends/caf_areas.geojson: caf_areas.geojson
        depends/bdi_areas.geojson: bdi_areas.geojson
        depends/gmb_areas.geojson: gmb_areas.geojson
        depends/ben_areas.geojson: ben_areas.geojson
        depends/sen_areas.geojson: sen_areas.geojson
  - bwa_survey_behav_men:
      id: latest
      use:
        depends/bwa_survey_indicators_sexbehav.csv: bwa_survey_indicators_sexbehav.csv
        depends/bwa_hiv_indicators_sexbehav.csv: bwa_hiv_indicators_sexbehav.csv
  - cmr_survey_behav_men:
      id: latest
      use:
        depends/cmr_survey_indicators_sexbehav.csv: cmr_survey_indicators_sexbehav.csv
        depends/cmr_hiv_indicators_sexbehav.csv: cmr_hiv_indicators_sexbehav.csv
  - ken_survey_behav_men:
      id: latest
      use:
        depends/ken_survey_indicators_sexbehav.csv: ken_survey_indicators_sexbehav.csv
        depends/ken_hiv_indicators_sexbehav.csv: ken_hiv_indicators_sexbehav.csv
  - lso_survey_behav_men:
      id: latest
      use:
        depends/lso_survey_indicators_sexbehav.csv: lso_survey_indicators_sexbehav.csv
        depends/lso_hiv_indicators_sexbehav.csv: lso_hiv_indicators_sexbehav.csv
  - moz_survey_behav_men:
      id: latest
      use:
        depends/moz_survey_indicators_sexbehav.csv: moz_survey_indicators_sexbehav.csv
        depends/moz_hiv_indicators_sexbehav.csv: moz_hiv_indicators_sexbehav.csv
  - mwi_survey_behav_men:
      id: latest
      use:
        depends/mwi_survey_indicators_sexbehav.csv: mwi_survey_indicators_sexbehav.csv
        depends/mwi_hiv_indicators_sexbehav.csv: mwi_hiv_indicators_sexbehav.csv
  - nam_survey_behav_men:
      id: latest
      use:
        depends/nam_survey_indicators_sexbehav.csv: nam_survey_indicators_sexbehav.csv
        depends/nam_hiv_indicators_sexbehav.csv: nam_hiv_indicators_sexbehav.csv
  - swz_survey_behav_men:
      id: latest
      use:
        depends/swz_survey_indicators_sexbehav.csv: swz_survey_indicators_sexbehav.csv
        depends/swz_hiv_indicators_sexbehav.csv: swz_hiv_indicators_sexbehav.csv
  - tza_survey_behav_men:
      id: latest
      use:
        depends/tza_survey_indicators_sexbehav.csv: tza_survey_indicators_sexbehav.csv
        depends/tza_hiv_indicators_sexbehav.csv: tza_hiv_indicators_sexbehav.csv
  - uga_survey_behav_men:
      id: latest
      use:
        depends/uga_survey_indicators_sexbehav.csv: uga_survey_indicators_sexbehav.csv
        depends/uga_hiv_indicators_sexbehav.csv: uga_hiv_indicators_sexbehav.csv
  - zaf_survey_behav_men:
      id: latest
      use:
        depends/zaf_survey_indicators_sexbehav.csv: zaf_survey_indicators_sexbehav.csv
        depends/zaf_hiv_indicators_sexbehav.csv: zaf_hiv_indicators_sexbehav.csv
  - zmb_survey_behav_men:
      id: latest
      use:
        depends/zmb_survey_indicators_sexbehav.csv: zmb_survey_indicators_sexbehav.csv
        depends/zmb_hiv_indicators_sexbehav.csv: zmb_hiv_indicators_sexbehav.csv
  - zwe_survey_behav_men:
      id: latest
      use:
        depends/zwe_survey_indicators_sexbehav.csv: zwe_survey_indicators_sexbehav.csv
        depends/zwe_hiv_indicators_sexbehav.csv: zwe_hiv_indicators_sexbehav.csv
  - bfa_survey_behav_men:
      id: latest
      use:
        depends/bfa_survey_indicators_sexbehav.csv: bfa_survey_indicators_sexbehav.csv
        depends/bfa_hiv_indicators_sexbehav.csv: bfa_hiv_indicators_sexbehav.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "BWA")
  #     use:
  #       depends/bwa_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "CMR")
  #     use:
  #       depends/cmr_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "KEN")
  #     use:
  #       depends/ken_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "LSO")
  #     use:
  #       depends/lso_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "MOZ")
  #     use:
  #       depends/moz_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "MWI")
  #     use:
  #       depends/mwi_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "NAM")
  #     use:
  #       depends/nam_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "SWZ")
  #     use:
  #       depends/swz_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "TZA")
  #     use:
  #       depends/tza_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "UGA")
  #     use:
  #       depends/uga_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "ZAF")
  #     use:
  #       depends/zaf_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "ZMB")
  #     use:
  #       depends/zmb_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "ZWE")
  #     use:
  #       depends/zwe_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "AGO")
  #     use:
  #       depends/ago_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "BDI")
  #     use:
  #       depends/bdi_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "COD")
  #     use:
  #       depends/cod_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "GAB")
  #     use:
  #       depends/gab_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "RWA")
  #     use:
  #       depends/rwa_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "ETH")
  #     use:
  #       depends/eth_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "TCD")
  #     use:
  #       depends/tcd_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "CIV")
  #     use:
  #       depends/civ_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "GHA")
  #     use:
  #       depends/gha_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "GIN")
  #     use:
  #       depends/gin_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "LBR")
  #     use:
  #       depends/lbr_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "MLI")
  #     use:
  #       depends/mli_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "NER")
  #     use:
  #       depends/ner_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "SLE")
  #     use:
  #       depends/sle_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "TGO")
  #     use:
  #       depends/tgo_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "BFA")
  #     use:
  #       depends/bfa_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "COG")
  #     use:
  #       depends/cog_interpolated-population.csv: interpolated_population.csv
  # - aaa_scale_pop:
  #     id: latest(parameter:iso3 == "CAF")
  #     use:
  #       depends/caf_interpolated-population.csv: interpolated_population.csv
  - ago_survey_behav_men:
      id: latest
      use:
        depends/ago_survey_indicators_sexbehav.csv: ago_survey_indicators_sexbehav.csv
        depends/ago_hiv_indicators_sexbehav.csv: ago_hiv_indicators_sexbehav.csv
  - bdi_survey_behav_men:
      id: latest
      use:
        depends/bdi_survey_indicators_sexbehav.csv: bdi_survey_indicators_sexbehav.csv
        depends/bdi_hiv_indicators_sexbehav.csv: bdi_hiv_indicators_sexbehav.csv
  - cod_survey_behav_men:
      id: latest
      use:
        depends/cod_survey_indicators_sexbehav.csv: cod_survey_indicators_sexbehav.csv
        depends/cod_hiv_indicators_sexbehav.csv: cod_hiv_indicators_sexbehav.csv
  - gab_survey_behav_men:
      id: latest
      use:
        depends/gab_survey_indicators_sexbehav.csv: gab_survey_indicators_sexbehav.csv
        depends/gab_hiv_indicators_sexbehav.csv: gab_hiv_indicators_sexbehav.csv
  - rwa_survey_behav_men:
      id: latest
      use:
        depends/rwa_survey_indicators_sexbehav.csv: rwa_survey_indicators_sexbehav.csv
        depends/rwa_hiv_indicators_sexbehav.csv: rwa_hiv_indicators_sexbehav.csv
  - eth_survey_behav_men:
      id: latest
      use:
        depends/eth_survey_indicators_sexbehav.csv: eth_survey_indicators_sexbehav.csv
        depends/eth_hiv_indicators_sexbehav.csv: eth_hiv_indicators_sexbehav.csv
  #- hti_survey_behav_men:
   #   id: latest
    #  use:
     #   depends/hti_survey_indicators_sexbehav.csv: hti_survey_indicators_sexbehav.csv
      #  depends/hti_hiv_indicators_sexbehav.csv: hti_hiv_indicators_sexbehav.csv
  - tcd_survey_behav_men:
      id: latest
      use:
        depends/tcd_survey_indicators_sexbehav.csv: tcd_survey_indicators_sexbehav.csv
        depends/tcd_hiv_indicators_sexbehav.csv: tcd_hiv_indicators_sexbehav.csv
  - civ_survey_behav_men:
      id: latest
      use:
        depends/civ_survey_indicators_sexbehav.csv: civ_survey_indicators_sexbehav.csv
        depends/civ_hiv_indicators_sexbehav.csv: civ_hiv_indicators_sexbehav.csv
  - gha_survey_behav_men:
      id: latest
      use:
        depends/gha_survey_indicators_sexbehav.csv: gha_survey_indicators_sexbehav.csv
        depends/gha_hiv_indicators_sexbehav.csv: gha_hiv_indicators_sexbehav.csv
  - gin_survey_behav_men:
      id: latest
      use:
        depends/gin_survey_indicators_sexbehav.csv: gin_survey_indicators_sexbehav.csv
        depends/gin_hiv_indicators_sexbehav.csv: gin_hiv_indicators_sexbehav.csv
  - lbr_survey_behav_men:
      id: latest
      use:
        depends/lbr_survey_indicators_sexbehav.csv: lbr_survey_indicators_sexbehav.csv
        depends/lbr_hiv_indicators_sexbehav.csv: lbr_hiv_indicators_sexbehav.csv
  - mli_survey_behav_men:
      id: latest
      use:
        depends/mli_survey_indicators_sexbehav.csv: mli_survey_indicators_sexbehav.csv
        depends/mli_hiv_indicators_sexbehav.csv: mli_hiv_indicators_sexbehav.csv
  - ner_survey_behav_men:
      id: latest
      use:
        depends/ner_survey_indicators_sexbehav.csv: ner_survey_indicators_sexbehav.csv
        depends/ner_hiv_indicators_sexbehav.csv: ner_hiv_indicators_sexbehav.csv
  - sle_survey_behav_men:
      id: latest
      use:
        depends/sle_survey_indicators_sexbehav.csv: sle_survey_indicators_sexbehav.csv
        depends/sle_hiv_indicators_sexbehav.csv: sle_hiv_indicators_sexbehav.csv
  - tgo_survey_behav_men:
      id: latest
      use:
        depends/tgo_survey_indicators_sexbehav.csv: tgo_survey_indicators_sexbehav.csv
        depends/tgo_hiv_indicators_sexbehav.csv: tgo_hiv_indicators_sexbehav.csv
  - cog_survey_behav_men:
      id: latest
      use:
        depends/cog_survey_indicators_sexbehav.csv: cog_survey_indicators_sexbehav.csv
        depends/cog_hiv_indicators_sexbehav.csv: cog_hiv_indicators_sexbehav.csv
  - gmb_survey_behav_men:
      id: latest
      use:
        depends/gmb_survey_indicators_sexbehav.csv: gmb_survey_indicators_sexbehav.csv
        depends/gmb_hiv_indicators_sexbehav.csv: gmb_hiv_indicators_sexbehav.csv
  - sen_survey_behav_men:
      id: latest
      use:
        depends/sen_survey_indicators_sexbehav.csv: sen_survey_indicators_sexbehav.csv
        depends/sen_hiv_indicators_sexbehav.csv: sen_hiv_indicators_sexbehav.csv
  - caf_survey_behav_men:
      id: latest
      use:
        depends/caf_survey_indicators_sexbehav.csv: caf_survey_indicators_sexbehav.csv
  - ben_survey_behav_men:
      id: latest
      use:
        depends/ben_survey_indicators_sexbehav.csv: ben_survey_indicators_sexbehav.csv
